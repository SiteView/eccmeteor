{"version":3,"file":"\\packages\\HTML5-History-API.js","sources":["HTML5-History-API/HTML5-History-API\\history.iegte8.js","HTML5-History-API/settings.js"],"names":[],"mappings":";;;;;;;;AAAA,E;AACA,wC;AACA,E;AACA,0D;AACA,E;AACA,kE;AACA,E;AACA,wB;AACA,E;AACA,gD;AACA,uD;AACA,yC;AACA,E;AACA,yB;AACA,G;AACA,mB;AACA,0B;AACA,mC;AACA,mB;AACA,mD;AACA,gC;AACA,kD;AACA,uC;AACA,kC;AACA,6B;AACA,8B;AACA,+C;AACA,yC;AACA,8C;AACA,uC;AACA,4F;AACA,sC;AACA,4C;AACA,mD;AACA,+C;AACA,yD;AACA,gD;AACA,iD;AACA,wE;AACA,iE;AACA,gD;AACA,+C;AACA,yG;AACA,sF;AACA,qC;AACA,6B;AACA,sD;AACA,wH;AACA,sD;AACA,qG;AACA,sD;AACA,iF;AACA,8C;AACA,gD;AACA,sD;AACA,6C;AACA,uB;AACA,iE;AACA,iC;AACA,6C;AACA,2C;AACA,oD;AACA,wC;AACA,sC;AACA,gD;AACA,iC;AACA,8C;AACA,mC;AACA,6D;AACA,0B;AACA,oD;AACA,wB;;AAEA,O;AACA,qD;AACA,4C;AACA,M;AACA,qB;AACA,O;AACA,6B;AACA,6B;AACA,0B;AACA,M;;AAEA,O;AACA,uD;AACA,gE;AACA,mD;AACA,M;AACA,qB;AACA,O;AACA,8B;AACA,W;AACA,6B;AACA,iC;AACA,qC;AACA,W;AACA,8C;AACA,iG;AACA,6E;AACA,4C;AACA,qE;AACA,mD;AACA,mD;AACA,0C;AACA,qG;AACA,yD;AACA,qB;AACA,mF;AACA,yD;AACA,+E;AACA,uF;AACA,qB;AACA,8C;AACA,iE;AACA,uG;AACA,iB;AACA,a;AACA,U;AACA,W;AACA,+C;AACA,0B;AACA,U;AACA,6B;AACA,gC;AACA,gC;AACA,gC;AACA,W;AACA,gD;AACA,iF;AACA,oC;AACA,U;AACA,W;AACA,+C;AACA,+C;AACA,wC;AACA,U;AACA,6B;AACA,gC;AACA,gC;AACA,gC;AACA,W;AACA,mD;AACA,qD;AACA,uF;AACA,0C;AACA,U;AACA,W;AACA,sD;AACA,mD;AACA,0D;AACA,U;AACA,6B;AACA,W;AACA,qB;AACA,kC;AACA,wC;AACA,c;AACA,6B;AACA,6E;AACA,a;AACA,U;AACA,W;AACA,mD;AACA,kC;AACA,U;AACA,6B;AACA,W;AACA,kB;AACA,6B;AACA,iE;AACA,a;AACA,S;AACA,M;;AAEA,O;AACA,gD;AACA,kD;AACA,+C;AACA,sD;AACA,M;AACA,qB;AACA,O;AACA,+B;AACA,W;AACA,uC;AACA,U;AACA,sC;AACA,W;AACA,+B;AACA,gD;AACA,uC;AACA,oB;AACA,2C;AACA,a;AACA,U;AACA,W;AACA,oC;AACA,U;AACA,sC;AACA,W;AACA,4B;AACA,oC;AACA,U;AACA,W;AACA,wC;AACA,4C;AACA,6B;AACA,U;AACA,sC;AACA,W;AACA,gC;AACA,gD;AACA,6C;AACA,oB;AACA,4C;AACA,a;AACA,U;AACA,W;AACA,+C;AACA,U;AACA,sC;AACA,W;AACA,8B;AACA,6B;AACA,U;AACA,W;AACA,+C;AACA,mD;AACA,U;AACA,sC;AACA,W;AACA,iB;AACA,6B;AACA,wC;AACA,a;AACA,U;AACA,W;AACA,+C;AACA,U;AACA,sC;AACA,W;AACA,yB;AACA,W;AACA,2D;AACA,U;AACA,sC;AACA,W;AACA,qB;AACA,W;AACA,2C;AACA,U;AACA,sC;AACA,W;AACA,yB;AACA,W;AACA,kD;AACA,U;AACA,sC;AACA,W;AACA,qB;AACA,W;AACA,gD;AACA,U;AACA,sC;AACA,W;AACA,qB;AACA,6B;AACA,4C;AACA,a;AACA,U;AACA,W;AACA,4C;AACA,+C;AACA,oC;AACA,U;AACA,sC;AACA,W;AACA,mB;AACA,6B;AACA,0C;AACA,a;AACA,U;AACA,W;AACA,0C;AACA,+C;AACA,kC;AACA,U;AACA,sC;AACA,W;AACA,iB;AACA,kC;AACA,sF;AACA,c;AACA,6B;AACA,wC;AACA,a;AACA,S;AACA,M;;AAEA,O;AACA,0B;AACA,M;AACA,mB;AACA,O;AACA,8B;AACA,gB;AACA,K;;AAEA,O;AACA,0F;AACA,M;AACA,6B;AACA,0C;AACA,kC;AACA,uB;AACA,O;AACA,yD;AACA,sH;AACA,wC;AACA,mG;AACA,oD;AACA,8E;AACA,gF;AACA,wE;AACA,gE;AACA,mG;AACA,kB;AACA,gB;AACA,iE;AACA,yD;AACA,mD;AACA,oC;AACA,yD;AACA,uD;AACA,kG;AACA,2F;AACA,a;AACA,S;AACA,+D;AACA,kC;AACA,sC;AACA,iD;AACA,yC;AACA,kE;AACA,iB;AACA,wC;AACA,2B;AACA,qC;AACA,e;AACA,8D;AACA,8C;AACA,gD;AACA,iF;AACA,8G;AACA,iB;AACA,gB;AACA,sD;AACA,iC;AACA,wB;AACA,iC;AACA,mC;AACA,gC;AACA,4B;AACA,wB;AACA,gC;AACA,4B;AACA,mC;AACA,S;AACA,K;;AAEA,O;AACA,yD;AACA,O;AACA,sC;AACA,yB;AACA,6B;AACA,oD;AACA,iE;AACA,gB;AACA,wE;AACA,oC;AACA,uE;AACA,a;AACA,S;AACA,a;AACA,qD;AACA,sB;AACA,8B;AACA,S;AACA,yD;AACA,yD;AACA,iC;AACA,8C;AACA,wF;AACA,oB;AACA,yD;AACA,+B;AACA,uE;AACA,sF;AACA,iB;AACA,a;AACA,kB;AACA,K;;AAEA,O;AACA,kE;AACA,iE;AACA,+D;AACA,kE;AACA,yD;AACA,M;AACA,mF;AACA,oE;AACA,2E;AACA,0F;AACA,qF;AACA,O;AACA,oE;AACA,+C;AACA,wD;AACA,wF;AACA,8C;AACA,8C;AACA,mD;AACA,yD;AACA,gC;AACA,4B;AACA,gC;AACA,W;;AAEA,a;AACA,0E;AACA,+C;AACA,+B;AACA,wC;AACA,qE;AACA,qD;AACA,sB;AACA,S;;AAEA,iG;AACA,mD;AACA,2E;AACA,0C;AACA,8E;AACA,wD;AACA,wD;AACA,mC;AACA,4C;AACA,8E;AACA,gF;AACA,gF;AACA,a;;AAEA,kG;AACA,8E;AACA,qB;AACA,6D;AACA,qD;AACA,4D;AACA,wC;AACA,8B;AACA,iB;AACA,oD;AACA,6C;AACA,uB;AACA,kE;AACA,kE;AACA,sC;AACA,uB;AACA,uE;AACA,wB;AACA,yB;AACA,2B;AACA,kE;AACA,sE;AACA,wD;AACA,2B;AACA,6E;AACA,kC;AACA,qB;AACA,iB;AACA,gD;AACA,6C;;AAEA,8D;AACA,oE;AACA,qB;AACA,yB;AACA,gE;AACA,yD;AACA,iH;AACA,gD;AACA,6E;AACA,oE;AACA,qE;AACA,6B;AACA,yB;AACA,6B;AACA,sG;AACA,+D;AACA,sC;AACA,yB;AACA,sC;AACA,kC;AACA,iH;AACA,uF;AACA,qB;AACA,8B;AACA,8C;AACA,iC;AACA,iB;AACA,a;AACA,S;;AAEA,sB;AACA,K;;AAEA,O;AACA,8C;AACA,M;AACA,0D;AACA,8D;AACA,iD;AACA,wD;AACA,O;AACA,oE;AACA,sC;AACA,yF;AACA,0E;AACA,uC;AACA,6D;AACA,iC;AACA,W;AACA,uC;AACA,wD;AACA,gC;AACA,W;AACA,0B;AACA,K;;AAEA,O;AACA,4F;AACA,M;AACA,6E;AACA,gF;AACA,oG;AACA,mB;AACA,O;AACA,yD;AACA,kC;AACA,oE;AACA,6C;AACA,gB;AACA,yE;AACA,oE;AACA,uC;AACA,iE;AACA,oB;AACA,mD;AACA,a;AACA,S;AACA,K;;AAEA,O;AACA,+F;AACA,M;AACA,4E;AACA,qF;AACA,8E;AACA,mB;AACA,O;AACA,4D;AACA,qC;AACA,mB;AACA,4C;AACA,2C;AACA,sC;AACA,0B;AACA,iB;AACA,a;AACA,gB;AACA,kD;AACA,S;AACA,K;;AAEA,O;AACA,uF;AACA,M;AACA,+F;AACA,8F;AACA,mG;AACA,O;AACA,gD;AACA,mG;AACA,yC;AACA,mB;AACA,mE;AACA,0E;AACA,6C;AACA,8E;AACA,0G;AACA,wE;AACA,wE;AACA,4D;AACA,6C;AACA,wC;AACA,0C;AACA,yB;AACA,uB;AACA,iB;AACA,a;AACA,uG;AACA,iF;AACA,4D;AACA,mE;AACA,6D;AACA,kD;AACA,a;AACA,wB;AACA,gB;AACA,gD;AACA,S;AACA,K;;AAEA,O;AACA,mC;AACA,O;AACA,6B;AACA,oG;AACA,0B;AACA,kD;AACA,gB;AACA,gC;AACA,S;AACA,sC;AACA,sD;AACA,yB;AACA,K;;AAEA,O;AACA,gD;AACA,O;AACA,iC;AACA,iC;AACA,uC;AACA,2B;AACA,S;AACA,K;;AAEA,O;AACA,gE;AACA,M;AACA,4B;AACA,4B;AACA,iC;AACA,qC;AACA,mB;AACA,O;AACA,6D;AACA,mC;AACA,gC;AACA,0C;AACA,+C;AACA,+D;AACA,kE;AACA,uC;AACA,8B;AACA,8D;AACA,qE;AACA,wB;AACA,gE;AACA,6D;AACA,iB;AACA,a;AACA,S;AACA,sD;AACA,sD;AACA,S;AACA,mC;AACA,K;;AAEA,O;AACA,iE;AACA,M;AACA,2B;AACA,mB;AACA,O;AACA,kC;AACA,4E;AACA,sB;AACA,8G;AACA,8D;AACA,6B;AACA,mH;AACA,+B;AACA,a;AACA,mC;AACA,0C;;AAEA,uD;AACA,0C;AACA,iE;AACA,gC;AACA,kD;AACA,kD;AACA,a;AACA,4D;AACA,0D;AACA,qC;AACA,a;AACA,S;AACA,+B;AACA,sC;AACA,K;;AAEA,O;AACA,iD;AACA,M;AACA,4B;AACA,mB;AACA,O;AACA,+B;AACA,kG;AACA,+B;AACA,uF;AACA,8C;AACA,6G;AACA,0D;AACA,yG;AACA,4D;AACA,qD;AACA,uE;AACA,mD;AACA,wB;AACA,iB;AACA,8C;AACA,iC;AACA,sB;AACA,c;AACA,iC;AACA,kF;AACA,8C;AACA,0D;AACA,uE;AACA,+B;AACA,S;AACA,K;;AAEA,O;AACA,qD;AACA,M;AACA,e;AACA,O;AACA,+B;AACA,sC;AACA,sD;AACA,qH;AACA,qE;AACA,qC;AACA,kE;AACA,sG;AACA,iC;AACA,qD;AACA,+D;AACA,iB;AACA,+C;AACA,2C;AACA,2C;AACA,wB;AACA,8C;AACA,iB;AACA,a;AACA,S;AACA,K;;AAEA,O;AACA,gD;AACA,M;AACA,kB;AACA,O;AACA,qC;AACA,oF;AACA,sE;AACA,sD;AACA,0G;AACA,oD;AACA,S;AACA,K;;AAEA,O;AACA,6B;AACA,M;AACA,iF;AACA,O;AACA,2B;AACA,W;AACA,oD;AACA,W;AACA,8D;AACA,gE;AACA,sE;AACA,oE;AACA,kG;AACA,W;;AAEA,W;AACA,uE;AACA,W;AACA,sE;;AAEA,6D;AACA,uH;;AAEA,mE;AACA,4C;AACA,oD;AACA,+C;AACA,S;;AAEA,mC;AACA,iD;AACA,sC;AACA,mD;AACA,8D;AACA,kG;AACA,0D;AACA,4B;AACA,qE;AACA,mG;AACA,2D;AACA,6F;AACA,2E;AACA,sD;AACA,0E;AACA,iF;AACA,6B;AACA,6B;AACA,mE;AACA,qF;;AAEA,oE;AACA,6F;;AAEA,oD;AACA,yC;AACA,yB;;AAEA,0F;AACA,qD;AACA,+E;AACA,yB;AACA,qB;AACA,iB;AACA,a;AACA,S;;AAEA,gC;AACA,mC;AACA,wC;AACA,S;;AAEA,4E;AACA,qD;AACA,oC;AACA,S;;AAEA,kC;AACA,mC;AACA,4F;AACA,S;;AAEA,iD;AACA,yB;AACA,gB;AACA,wF;AACA,0C;AACA,a;AACA,e;AACA,8E;AACA,0E;AACA,wD;AACA,e;AACA,8D;AACA,S;;AAEA,+B;AACA,oB;AACA,K;;AAEA,O;AACA,2B;AACA,O;AACA,wB;AACA,8C;AACA,gD;AACA,6C;AACA,e;AACA,K;;AAEA,O;AACA,oD;AACA,iD;AACA,gD;AACA,8C;AACA,qC;AACA,M;AACA,sB;AACA,a;AACA,O;AACA,oD;;AAEA,O;AACA,kD;AACA,O;AACA,oD;AACA,0D;AACA,8C;;AAEA,W;;;;;;;;;;;;;;;;;;ACx5BA,sE;AACA,mE;AACA,sE;AACA,mB","sourcesContent":["/*\r\n * History API JavaScript Library v4.0.0\r\n *\r\n * Support: IE8+, FF3+, Opera 9+, Safari, Chrome and other\r\n *\r\n * Copyright 2011-2013, Dmitrii Pakhtinov ( spb.piksel@gmail.com )\r\n *\r\n * http://spb-piksel.ru/\r\n *\r\n * Dual licensed under the MIT and GPL licenses:\r\n *   http://www.opensource.org/licenses/mit-license.php\r\n *   http://www.gnu.org/licenses/gpl.html\r\n *\r\n * Update: 19.05.13 22:46\r\n */\r\n(function(window) {\r\n    // symlink to document\r\n    var document = window.document;\r\n    // HTML element\r\n    var documentElement = document.documentElement;\r\n    // symlink to sessionStorage\r\n    var sessionStorage = window['sessionStorage'];\r\n    // symlink to constructor of Object\r\n    var Object = window['Object'];\r\n    // symlink to JSON Object\r\n    var JSON = window['JSON'];\r\n    // symlink to instance object of 'Location'\r\n    var windowLocation = window.location;\r\n    // symlink to instance object of 'History'\r\n    var windowHistory = window.history;\r\n    // new instance of 'History'. The default is a reference to the original object instance\r\n    var historyObject = windowHistory;\r\n    // symlink to method 'history.pushState'\r\n    var historyPushState = windowHistory.pushState;\r\n    // symlink to method 'history.replaceState'\r\n    var historyReplaceState = windowHistory.replaceState;\r\n    // if the browser supports HTML5-History-API\r\n    var isSupportHistoryAPI = !!historyPushState;\r\n    // verifies the presence of an object 'state' in interface 'History'\r\n    var isSupportStateObjectInHistory = 'state' in windowHistory;\r\n    // symlink to method 'Object.defineProperty'\r\n    var defineProperty = Object.defineProperty;\r\n    // new instance of 'Location', for IE8 will use the element HTMLAnchorElement, instead of pure object\r\n    var locationObject = redefineProperty({}, 't') ? {} : document.createElement('a');\r\n    // prefix for the names of events\r\n    var eventNamePrefix = '';\r\n    // String that will contain the name of the method\r\n    var addEventListenerName = window.addEventListener ? 'addEventListener' : (eventNamePrefix = 'on') && 'attachEvent';\r\n    // String that will contain the name of the method\r\n    var removeEventListenerName = window.removeEventListener ? 'removeEventListener' : 'detachEvent';\r\n    // String that will contain the name of the method\r\n    var dispatchEventName = window.dispatchEvent ? 'dispatchEvent' : 'fireEvent';\r\n    // reference native methods for the events\r\n    var addEvent = window[addEventListenerName];\r\n    var removeEvent = window[removeEventListenerName];\r\n    var dispatch = window[dispatchEventName];\r\n    // default settings\r\n    var settings = {\"basepath\": '/', \"redirect\": 0, \"type\": '/'};\r\n    // key for the sessionStorage\r\n    var sessionStorageKey = '__historyAPI__';\r\n    // Anchor Element for parseURL function\r\n    var anchorElement = document.createElement('a');\r\n    // last URL before change to new URL\r\n    var lastURL = windowLocation.href;\r\n    // Control URL, need to fix the bug in Opera\r\n    var checkUrlForPopState = '';\r\n    // trigger event 'onpopstate' on page load\r\n    var isFireInitialState = false;\r\n    // store a list of 'state' objects in the current session\r\n    var stateStorage = {};\r\n    // in this object will be stored custom handlers\r\n    var eventsList = {};\r\n\r\n    /**\r\n     * Properties that will be replaced in the global\r\n     * object 'window', to prevent conflicts\r\n     *\r\n     * @type {Object}\r\n     */\r\n    var eventsDescriptors = {\r\n        \"onhashchange\": null,\r\n        \"onpopstate\": null\r\n    };\r\n\r\n    /**\r\n     * Properties that will be replaced/added to object\r\n     * 'window.history', includes the object 'history.location',\r\n     * for a complete the work with the URL address\r\n     *\r\n     * @type {Object}\r\n     */\r\n    var historyDescriptors = {\r\n        /**\r\n         * @namespace history\r\n         * @param {String} [type]\r\n         * @param {String} [basepath]\r\n         */\r\n        \"redirect\": function(type, basepath) {\r\n            settings[\"basepath\"] = basepath = basepath == null ? settings[\"basepath\"] : basepath;\r\n            settings[\"type\"] = type = type == null ? settings[\"type\"] : type;\r\n            if (window.top == window.self) {\r\n                var relative = parseURL(null, false, true)._relative;\r\n                var search = windowLocation.search;\r\n                var path = windowLocation.pathname;\r\n                if (isSupportHistoryAPI) {\r\n                    if (relative != basepath && (new RegExp(\"^\" + basepath + \"$\", \"i\")).test(path)) {\r\n                        windowLocation.replace(relative);\r\n                    }\r\n                    if ((new RegExp(\"^\" + basepath + \"$\", \"i\")).test(path + '/')) {\r\n                        windowLocation.replace(basepath);\r\n                    } else if (!(new RegExp(\"^\" + basepath, \"i\")).test(path)) {\r\n                        windowLocation.replace(path.replace(/^\\//, basepath) + search);\r\n                    }\r\n                } else if (path != basepath) {\r\n                    windowLocation.replace(basepath + '#' + path.\r\n                        replace(new RegExp(\"^\" + basepath, \"i\"), type) + search + windowLocation.hash);\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * The method adds a state object entry\r\n         * to the history.\r\n         *\r\n         * @namespace history\r\n         * @param {Object} state\r\n         * @param {string} title\r\n         * @param {string} [url]\r\n         */\r\n        pushState: function(state, title, url) {\r\n            historyPushState && historyPushState.apply(windowHistory, arguments);\r\n            changeState(state, url);\r\n        },\r\n        /**\r\n         * The method updates the state object,\r\n         * title, and optionally the URL of the\r\n         * current entry in the history.\r\n         *\r\n         * @namespace history\r\n         * @param {Object} state\r\n         * @param {string} title\r\n         * @param {string} [url]\r\n         */\r\n        replaceState: function(state, title, url) {\r\n            delete stateStorage[windowLocation.href];\r\n            historyReplaceState && historyReplaceState.apply(windowHistory, arguments);\r\n            changeState(state, url, true);\r\n        },\r\n        /**\r\n         * Object 'history.location' is similar to the\r\n         * object 'window.location', except that in\r\n         * HTML4 browsers it will behave a bit differently\r\n         *\r\n         * @namespace history\r\n         */\r\n        \"location\": {\r\n            set: function(value) {\r\n                window.location = value;\r\n            },\r\n            get: function() {\r\n                return isSupportHistoryAPI ? windowLocation : locationObject;\r\n            }\r\n        },\r\n        /**\r\n         * A state object is an object representing\r\n         * a user interface state.\r\n         *\r\n         * @namespace history\r\n         */\r\n        \"state\": {\r\n            get: function() {\r\n                return stateStorage[windowLocation.href] || null;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Properties for object 'history.location'.\r\n     * Object 'history.location' is similar to the\r\n     * object 'window.location', except that in\r\n     * HTML4 browsers it will behave a bit differently\r\n     *\r\n     * @type {Object}\r\n     */\r\n    var locationDescriptors = {\r\n        /**\r\n         * Navigates to the given page.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        assign: function(url) {\r\n            if (('' + url).indexOf('#') === 0) {\r\n                changeState(null, url);\r\n            } else {\r\n                windowLocation.assign(url);\r\n            }\r\n        },\r\n        /**\r\n         * Reloads the current page.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        reload: function() {\r\n            windowLocation.reload();\r\n        },\r\n        /**\r\n         * Removes the current page from\r\n         * the session history and navigates\r\n         * to the given page.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        replace: function(url) {\r\n            if (('' + url).indexOf('#') === 0) {\r\n                changeState(null, url, true);\r\n            } else {\r\n                windowLocation.replace(url);\r\n            }\r\n        },\r\n        /**\r\n         * Returns the current page's location.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        toString: function() {\r\n            return this.href;\r\n        },\r\n        /**\r\n         * Returns the current page's location.\r\n         * Can be set, to navigate to another page.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        \"href\": {\r\n            get: function() {\r\n                return parseURL()._href;\r\n            }\r\n        },\r\n        /**\r\n         * Returns the current page's protocol.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        \"protocol\": null,\r\n        /**\r\n         * Returns the current page's host and port number.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        \"host\": null,\r\n        /**\r\n         * Returns the current page's host.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        \"hostname\": null,\r\n        /**\r\n         * Returns the current page's port number.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        \"port\": null,\r\n        /**\r\n         * Returns the current page's path only.\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        \"pathname\": {\r\n            get: function() {\r\n                return parseURL()._pathname;\r\n            }\r\n        },\r\n        /**\r\n         * Returns the current page's search\r\n         * string, beginning with the character\r\n         * '?' and to the symbol '#'\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        \"search\": {\r\n            get: function() {\r\n                return parseURL()._search;\r\n            }\r\n        },\r\n        /**\r\n         * Returns the current page's hash\r\n         * string, beginning with the character\r\n         * '#' and to the end line\r\n         *\r\n         * @namespace history.location\r\n         */\r\n        \"hash\": {\r\n            set: function(value) {\r\n                changeState(null, ('' + value).replace(/^(#|)/, '#'), false, lastURL);\r\n            },\r\n            get: function() {\r\n                return parseURL()._hash;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Just empty function\r\n     *\r\n     * @return void\r\n     */\r\n    function emptyFunction() {\r\n        // dummy\r\n    }\r\n\r\n    /**\r\n     * Prepares a parts of the current or specified reference for later use in the library\r\n     *\r\n     * @param {string} [href]\r\n     * @param {boolean} [isWindowLocation]\r\n     * @param {boolean} [isNotAPI]\r\n     * @return {Object}\r\n     */\r\n    function parseURL(href, isWindowLocation, isNotAPI) {\r\n        var re = /(?:([\\w0-9]+:))?(?:\\/\\/(?:[^@]*@)?([^\\/:\\?#]+)(?::([0-9]+))?)?([^\\?#]*)(?:(\\?[^#]+)|\\?)?(?:(#.*))?/;\r\n        if (href && !isWindowLocation) {\r\n            var current = parseURL(), _pathname = current._pathname, _protocol = current._protocol;\r\n            // convert relative link to the absolute\r\n            href = /^(?:[\\w0-9]+\\:)?\\/\\//.test(href) ? href.indexOf(\"/\") === 0\r\n                ? _protocol + href : href : _protocol + \"//\" + current._host + (\r\n                href.indexOf(\"/\") === 0 ? href : href.indexOf(\"?\") === 0\r\n                    ? _pathname + href : href.indexOf(\"#\") === 0\r\n                    ? _pathname + current._search + href : _pathname.replace(/[^\\/]+$/g, '') + href\r\n                );\r\n        } else {\r\n            href = isWindowLocation ? href : windowLocation.href;\r\n            // if current browser not support History-API\r\n            if (!isSupportHistoryAPI || isNotAPI) {\r\n                // get hash fragment\r\n                href = href.replace(/^[^#]*/, '') || \"#\";\r\n                // form the absolute link from the hash\r\n                href = windowLocation.protocol + '//' + windowLocation.host + settings['basepath']\r\n                    + href.replace(new RegExp(\"^#[\\/]?(?:\" + settings[\"type\"] + \")?\"), \"\");\r\n            }\r\n        }\r\n        // that would get rid of the links of the form: /../../\r\n        anchorElement.href = href;\r\n        // decompose the link in parts\r\n        var result = re.exec(anchorElement.href);\r\n        // host name with the port number\r\n        var host = result[2] + (result[3] ? ':' + result[3] : '');\r\n        // folder\r\n        var pathname = result[4] || '/';\r\n        // the query string\r\n        var search = result[5] || '';\r\n        // hash\r\n        var hash = result[6] === '#' ? '' : (result[6] || '');\r\n        // relative link, no protocol, no host\r\n        var relative = pathname + search + hash;\r\n        // special links for set to hash-link, if browser not support History API\r\n        var nohash = pathname.replace(new RegExp(\"^\" + settings[\"basepath\"], \"i\"), settings[\"type\"]) + search;\r\n        // result\r\n        return {\r\n            _href: result[1] + '//' + host + relative,\r\n            _protocol: result[1],\r\n            _host: host,\r\n            _hostname: result[2],\r\n            _port: result[3] || '',\r\n            _pathname: pathname,\r\n            _search: search,\r\n            _hash: hash,\r\n            _relative: relative,\r\n            _nohash: nohash,\r\n            _special: nohash + hash\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Initializing storage for the custom state's object\r\n     */\r\n    function storageInitialize(JSON) {\r\n        var storage = '';\r\n        if (sessionStorage) {\r\n            // get cache from the storage in browser\r\n            storage += sessionStorage.getItem(sessionStorageKey);\r\n        } else {\r\n            var cookie = document.cookie.split(sessionStorageKey + \"=\");\r\n            if (cookie.length > 1) {\r\n                storage += (cookie.pop().split(\";\").shift() || 'null');\r\n            }\r\n        }\r\n        try {\r\n            stateStorage = JSON.parse(storage) || {};\r\n        } catch(_e_) {\r\n            stateStorage = {};\r\n        }\r\n        // hang up the event handler to event unload page\r\n        addEvent(eventNamePrefix + 'unload', function() {\r\n            if (sessionStorage) {\r\n                // save current state's object\r\n                sessionStorage.setItem(sessionStorageKey, JSON.stringify(stateStorage));\r\n            } else {\r\n                // save the current 'state' in the cookie\r\n                var state = {};\r\n                if (state[windowLocation.href] = historyObject.state) {\r\n                    document.cookie = sessionStorageKey + '=' + JSON.stringify(state);\r\n                }\r\n            }\r\n        }, false);\r\n    }\r\n\r\n    /**\r\n     * This method is implemented to override the built-in(native)\r\n     * properties in the browser, unfortunately some browsers are\r\n     * not allowed to override all the properties and even add.\r\n     * For this reason, this was written by a method that tries to\r\n     * do everything necessary to get the desired result.\r\n     *\r\n     * @param {Object} object The object in which will be overridden/added property\r\n     * @param {String} prop The property name to be overridden/added\r\n     * @param {Object} [descriptor] An object containing properties set/get\r\n     * @param {Function} [onWrapped] The function to be called when the wrapper is created\r\n     * @return {Object|Boolean} Returns an object on success, otherwise returns false\r\n     */\r\n    function redefineProperty(object, prop, descriptor, onWrapped) {\r\n        // test only if descriptor is undefined\r\n        descriptor = descriptor || {set: emptyFunction};\r\n        // variable will have a value of true the success of attempts to set descriptors\r\n        var isDefinedSetter = !descriptor.set;\r\n        var isDefinedGetter = !descriptor.get;\r\n        // for tests of attempts to set descriptors\r\n        var test = {configurable: true, set: function() {\r\n            isDefinedSetter = 1;\r\n        }, get: function() {\r\n            isDefinedGetter = 1;\r\n        }};\r\n\r\n        try {\r\n            // testing for the possibility of overriding/adding properties\r\n            defineProperty(object, prop, test);\r\n            // running the test\r\n            object[prop] = object[prop];\r\n            // attempt to override property using the standard method\r\n            defineProperty(object, prop, descriptor);\r\n        } catch(_e_) {\r\n        }\r\n\r\n        // If the variable 'isDefined' has a false value, it means that need to try other methods\r\n        if (!isDefinedSetter || !isDefinedGetter) {\r\n            // try to override/add the property, using deprecated functions\r\n            if (object.__defineGetter__) {\r\n                // testing for the possibility of overriding/adding properties\r\n                object.__defineGetter__(prop, test.get);\r\n                object.__defineSetter__(prop, test.set);\r\n                // running the test\r\n                object[prop] = object[prop];\r\n                // attempt to override property using the deprecated functions\r\n                descriptor.get && object.__defineGetter__(prop, descriptor.get);\r\n                descriptor.set && object.__defineSetter__(prop, descriptor.set);\r\n            }\r\n\r\n            // Browser refused to override the property, using the standard and deprecated methods\r\n            if ((!isDefinedSetter || !isDefinedGetter) && object === window) {\r\n                try {\r\n                    // save original value from this property\r\n                    var originalValue = object[prop];\r\n                    // set null to built-in(native) property\r\n                    object[prop] = null;\r\n                } catch(_e_) {\r\n                }\r\n                // This rule for Internet Explorer 8\r\n                if ('execScript' in window) {\r\n                    /**\r\n                     * to IE8 override the global properties using\r\n                     * VBScript, declaring it in global scope with\r\n                     * the same names.\r\n                     */\r\n                    window['execScript']('Public ' + prop, 'VBScript');\r\n                } else {\r\n                    try {\r\n                        /**\r\n                         * This hack allows to override a property\r\n                         * with the set 'configurable: false', working\r\n                         * in the hack 'Safari' to 'Mac'\r\n                         */\r\n                        defineProperty(object, prop, {value: emptyFunction});\r\n                    } catch(_e_) {\r\n                    }\r\n                }\r\n                // set old value to new variable\r\n                object[prop] = originalValue;\r\n\r\n            } else if (!isDefinedSetter || !isDefinedGetter) {\r\n                // the last stage of trying to override the property\r\n                try {\r\n                    try {\r\n                        // wrap the object in a new empty object\r\n                        var temp = Object.create(object);\r\n                        defineProperty(Object.getPrototypeOf(temp) === object ? temp : object, prop, descriptor);\r\n                        for(var key in object) {\r\n                            // need to bind a function to the original object\r\n                            if (typeof object[key] === 'function') {\r\n                                temp[key] = object[key].bind(object);\r\n                            }\r\n                        }\r\n                        try {\r\n                            // to run a function that will inform about what the object was to wrapped\r\n                            onWrapped.call(temp, temp, object);\r\n                        } catch(_e_) {\r\n                        }\r\n                        object = temp;\r\n                    } catch(_e_) {\r\n                        // sometimes works override simply by assigning the prototype property of the constructor\r\n                        defineProperty(object.constructor.prototype, prop, descriptor);\r\n                    }\r\n                } catch(_e_) {\r\n                    // all methods have failed\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n\r\n        return object;\r\n    }\r\n\r\n    /**\r\n     * Adds the missing property in descriptor\r\n     *\r\n     * @param {Object} object An object that stores values\r\n     * @param {String} prop Name of the property in the object\r\n     * @param {Object|null} descriptor Descriptor\r\n     * @return {Object} Returns the generated descriptor\r\n     */\r\n    function prepareDescriptorsForObject(object, prop, descriptor) {\r\n        descriptor = descriptor || {};\r\n        // the default for the object 'location' is the standard object 'window.location'\r\n        object = object === locationDescriptors ? windowLocation : object;\r\n        // setter for object properties\r\n        descriptor.set = (descriptor.set || function(value) {\r\n            object[prop] = value;\r\n        });\r\n        // getter for object properties\r\n        descriptor.get = (descriptor.get || function() {\r\n            return object[prop];\r\n        });\r\n        return descriptor;\r\n    }\r\n\r\n    /**\r\n     * Wrapper for the methods 'addEventListener/attachEvent' in the context of the 'window'\r\n     *\r\n     * @param {String} event The event type for which the user is registering\r\n     * @param {Function} listener The method to be called when the event occurs.\r\n     * @param {Boolean} capture If true, capture indicates that the user wishes to initiate capture.\r\n     * @return void\r\n     */\r\n    function addEventListener(event, listener, capture) {\r\n        if (event in eventsList) {\r\n            // here stored the event listeners 'popstate/hashchange'\r\n            eventsList[event].push(listener);\r\n        } else {\r\n            // FireFox support non-standart four argument aWantsUntrusted\r\n            // https://github.com/devote/HTML5-History-API/issues/13\r\n            if (arguments.length > 3) {\r\n                addEvent(event, listener, capture, arguments[3]);\r\n            } else {\r\n                addEvent(event, listener, capture);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrapper for the methods 'removeEventListener/detachEvent' in the context of the 'window'\r\n     *\r\n     * @param {String} event The event type for which the user is registered\r\n     * @param {Function} listener The parameter indicates the Listener to be removed.\r\n     * @param {Boolean} capture Was registered as a capturing listener or not.\r\n     * @return void\r\n     */\r\n    function removeEventListener(event, listener, capture) {\r\n        var list = eventsList[event];\r\n        if (list) {\r\n            for(var i = list.length; --i;) {\r\n                if (list[i] === listener) {\r\n                    list.splice(i, 1);\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n            removeEvent(event, listener, capture);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Wrapper for the methods 'dispatchEvent/fireEvent' in the context of the 'window'\r\n     *\r\n     * @param {Event|String} event Instance of Event or event type string if 'eventObject' used\r\n     * @param {*} [eventObject] For Internet Explorer 8 required event object on this argument\r\n     * @return {Boolean} If 'preventDefault' was called the value is false, else the value is true.\r\n     */\r\n    function dispatchEvent(event, eventObject) {\r\n        var eventType = ('' + (typeof event === \"string\" ? event : event.type)).replace(/^on/, '');\r\n        var list = eventsList[eventType];\r\n        if (list) {\r\n            // need to understand that there is one object of Event\r\n            eventObject = typeof event === \"string\" ? eventObject : event;\r\n            if (eventObject.target == null) {\r\n                // need to override some of the properties of the Event object\r\n                for(var props = ['target', 'currentTarget', 'srcElement', 'type']; event = props.pop();) {\r\n                    // use 'redefineProperty' to override the properties\r\n                    eventObject = redefineProperty(eventObject, event, {\r\n                        get: event === 'type' ? function() {\r\n                            return eventType;\r\n                        } : function() {\r\n                            return window;\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            // run function defined in the attributes 'onpopstate/onhashchange' in the 'window' context\r\n            ((eventType === 'popstate' ? window.onpopstate : window.onhashchange)\r\n                || emptyFunction).call(window, eventObject);\r\n            // run other functions that are in the list of handlers\r\n            for(var i = 0, len = list.length; i < len; i++) {\r\n                list[i].call(window, eventObject);\r\n            }\r\n            return true;\r\n        } else {\r\n            return dispatch(event, eventObject);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * dispatch current state event\r\n     */\r\n    function firePopState() {\r\n        var o = document.createEvent ? document.createEvent('Event') : document.createEventObject();\r\n        if (o.initEvent) {\r\n            o.initEvent('popstate', false, false);\r\n        } else {\r\n            o.type = 'popstate';\r\n        }\r\n        o.state = historyObject.state;\r\n        // send a newly created events to be processed\r\n        dispatchEvent(o);\r\n    }\r\n\r\n    /**\r\n     * fire initial state for non-HTML5 browsers\r\n     */\r\n    function fireInitialState() {\r\n        if (isFireInitialState) {\r\n            isFireInitialState = false;\r\n            firePopState();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Change the data of the current history for HTML4 browsers\r\n     *\r\n     * @param {Object} state\r\n     * @param {string} [url]\r\n     * @param {Boolean} [replace]\r\n     * @param {string} [lastURLValue]\r\n     * @return void\r\n     */\r\n    function changeState(state, url, replace, lastURLValue) {\r\n        if (!isSupportHistoryAPI) {\r\n            // normalization url\r\n            var urlObject = parseURL(url);\r\n            // if current url not equal new url\r\n            if (urlObject._relative !== parseURL()._relative) {\r\n                // if empty lastURLValue to skip hash change event\r\n                lastURL = lastURLValue;\r\n                if (replace) {\r\n                    // only replace hash, not store to history\r\n                    windowLocation.replace(\"#\" + urlObject._special);\r\n                } else {\r\n                    // change hash and add new record to history\r\n                    windowLocation.hash = urlObject._special;\r\n                }\r\n            }\r\n        }\r\n        if (!isSupportStateObjectInHistory && state) {\r\n            stateStorage[windowLocation.href] = state;\r\n        }\r\n        isFireInitialState = false;\r\n    }\r\n\r\n    /**\r\n     * Event handler function changes the hash in the address bar\r\n     *\r\n     * @param {Event} event\r\n     * @return void\r\n     */\r\n    function onHashChange(event) {\r\n        // if not empty lastURL, otherwise skipped the current handler event\r\n        if (lastURL) {\r\n            // if checkUrlForPopState equal current url, this means that the event was raised popstate browser\r\n            if (checkUrlForPopState !== windowLocation.href) {\r\n                // otherwise,\r\n                // the browser does not support popstate event or just does not run the event by changing the hash.\r\n                firePopState();\r\n            }\r\n            // current event object\r\n            event = event || window.event;\r\n\r\n            var oldURLObject = parseURL(lastURL, true);\r\n            var newURLObject = parseURL();\r\n            // HTML4 browser not support properties oldURL/newURL\r\n            if (!event.oldURL) {\r\n                event.oldURL = oldURLObject._href;\r\n                event.newURL = newURLObject._href;\r\n            }\r\n            if (oldURLObject._hash !== newURLObject._hash) {\r\n                // if current hash not equal previous hash\r\n                dispatchEvent(event);\r\n            }\r\n        }\r\n        // new value to lastURL\r\n        lastURL = windowLocation.href;\r\n    }\r\n\r\n    /**\r\n     * The event handler is fully loaded document\r\n     *\r\n     * @param {*} [noScroll]\r\n     * @return void\r\n     */\r\n    function onLoad(noScroll) {\r\n        // Get rid of the events popstate when the first loading a document in the webkit browsers\r\n        setTimeout(function() {\r\n            // hang up the event handler for the built-in popstate event in the browser\r\n            addEvent('popstate', function(e) {\r\n                // set the current url, that suppress the creation of the popstate event by changing the hash\r\n                checkUrlForPopState = windowLocation.href;\r\n                // for Safari browser in OS Windows not implemented 'state' object in 'History' interface\r\n                // and not implemented in old HTML4 browsers\r\n                if (!isSupportStateObjectInHistory) {\r\n                    e = redefineProperty(e, 'state', {get: function() {\r\n                        return historyObject.state;\r\n                    }});\r\n                }\r\n                // send events to be processed\r\n                dispatchEvent(e);\r\n            }, false);\r\n        }, 0);\r\n        // for non-HTML5 browsers\r\n        if (!isSupportHistoryAPI && noScroll !== true && historyObject.location) {\r\n            // scroll window to anchor element\r\n            scrollToAnchorId(historyObject.location.hash);\r\n            // fire initial state for non-HTML5 browser after load page\r\n            fireInitialState();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * handler url with anchor for non-HTML5 browsers\r\n     *\r\n     * @param e\r\n     */\r\n    function onAnchorClick(e) {\r\n        var event = e || window.event;\r\n        var target = event.target || event.srcElement;\r\n        var defaultPrevented = \"defaultPrevented\" in event ? event['defaultPrevented'] : event.returnValue === false;\r\n        if (target && target.nodeName === \"A\" && !defaultPrevented) {\r\n            var current = parseURL();\r\n            var expect = parseURL(target.getAttribute(\"href\", 2));\r\n            var isEqualBaseURL = current._href.split('#').shift() === expect._href.split('#').shift();\r\n            if (isEqualBaseURL) {\r\n                if (current._hash !== expect._hash) {\r\n                    historyObject.location.hash = expect._hash;\r\n                }\r\n                scrollToAnchorId(expect._hash);\r\n                if (event.preventDefault) {\r\n                    event.preventDefault();\r\n                } else {\r\n                    event.returnValue = false;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Scroll page to current anchor in url-hash\r\n     *\r\n     * @param hash\r\n     */\r\n    function scrollToAnchorId(hash) {\r\n        var target = document.getElementById(hash = (hash || '').replace(/^#/, ''));\r\n        if (target && target.id === hash && target.nodeName === \"A\") {\r\n            var rect = target.getBoundingClientRect();\r\n            window.scrollTo((documentElement.scrollLeft || 0), rect.top + (documentElement.scrollTop || 0)\r\n                - (documentElement.clientTop || 0));\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Library initialization\r\n     *\r\n     * @return {Boolean} return true if all is well, otherwise return false value\r\n     */\r\n    function initialize() {\r\n        /**\r\n         * Get custom settings from the query string\r\n         */\r\n        var scripts = document.getElementsByTagName('script');\r\n        var src = (scripts[scripts.length - 1] || {}).src || '';\r\n        var arg = src.indexOf('?') !== -1 ? src.split('?').pop() : '';\r\n        arg.replace(/(\\w+)(?:=([^&]*))?/g, function(a, key, value) {\r\n            settings[key] = (value || (key === 'basepath' ? '/' : '')).replace(/^(0|false)$/, '');\r\n        });\r\n\r\n        /**\r\n         * hang up the event handler to listen to the events hashchange\r\n         */\r\n        addEvent(eventNamePrefix + 'hashchange', onHashChange, false);\r\n\r\n        // a list of objects with pairs of descriptors/object\r\n        var data = [locationDescriptors, locationObject, eventsDescriptors, window, historyDescriptors, historyObject];\r\n\r\n        // if browser support object 'state' in interface 'History'\r\n        if (isSupportStateObjectInHistory) {\r\n            // remove state property from descriptor\r\n            delete historyDescriptors['state'];\r\n        }\r\n\r\n        // initializing descriptors\r\n        for(var i = 0; i < data.length; i += 2) {\r\n            for(var prop in data[i]) {\r\n                if (data[i].hasOwnProperty(prop)) {\r\n                    if (typeof data[i][prop] === 'function') {\r\n                        // If the descriptor is a simple function, simply just assign it an object\r\n                        data[i + 1][prop] = data[i][prop];\r\n                    } else {\r\n                        // prepare the descriptor the required format\r\n                        var descriptor = prepareDescriptorsForObject(data[i], prop, data[i][prop]);\r\n                        // try to set the descriptor object\r\n                        if (!redefineProperty(data[i + 1], prop, descriptor, function(n, o) {\r\n                            // is satisfied if the failed override property\r\n                            if (o === historyObject) {\r\n                                // the problem occurs in Safari on the Mac\r\n                                window.history = historyObject = data[i + 1] = n;\r\n                            }\r\n                        })) {\r\n                            // if there is no possibility override.\r\n                            // This browser does not support descriptors, such as IE7\r\n\r\n                            // remove previously hung event handlers\r\n                            removeEvent(eventNamePrefix + 'hashchange', onHashChange, false);\r\n\r\n                            // fail to initialize :(\r\n                            return false;\r\n                        }\r\n\r\n                        // create a repository for custom handlers onpopstate/onhashchange\r\n                        if (data[i + 1] === window) {\r\n                            eventsList[prop] = eventsList[prop.substr(2)] = [];\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        // redirect if necessary\r\n        if (settings['redirect']) {\r\n            historyObject['redirect']();\r\n        }\r\n\r\n        // If browser does not support object 'state' in interface 'History'\r\n        if (!isSupportStateObjectInHistory && JSON) {\r\n            storageInitialize(JSON);\r\n        }\r\n\r\n        // track clicks on anchors\r\n        if (!isSupportHistoryAPI) {\r\n            document[addEventListenerName](eventNamePrefix + \"click\", onAnchorClick, false);\r\n        }\r\n\r\n        if (document.readyState === 'complete') {\r\n            onLoad(true);\r\n        } else {\r\n            if (!isSupportHistoryAPI && parseURL()._relative !== settings[\"basepath\"]) {\r\n                isFireInitialState = true;\r\n            }\r\n            /**\r\n             * Need to avoid triggering events popstate the initial page load.\r\n             * Hang handler popstate as will be fully loaded document that\r\n             * would prevent triggering event onpopstate\r\n             */\r\n            addEvent(eventNamePrefix + 'load', onLoad, false);\r\n        }\r\n\r\n        // everything went well\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Starting the library\r\n     */\r\n    if (!initialize()) {\r\n        // if unable to initialize descriptors\r\n        // therefore quite old browser and there\r\n        // is no sense to continue to perform\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * If the property history.emulate will be true,\r\n     * this will be talking about what's going on\r\n     * emulation capabilities HTML5-History-API.\r\n     * Otherwise there is no emulation, ie the\r\n     * built-in browser capabilities.\r\n     *\r\n     * @type {boolean}\r\n     * @const\r\n     */\r\n    historyObject['emulate'] = !isSupportHistoryAPI;\r\n\r\n    /**\r\n     * Replace the original methods on the wrapper\r\n     */\r\n    window[addEventListenerName] = addEventListener;\r\n    window[removeEventListenerName] = removeEventListener;\r\n    window[dispatchEventName] = dispatchEvent;\r\n\r\n})(window);","// Make sure that polyfilled links are redirected to correct links in \r\n// supporting browsers. Enables sharing links between IE and non-IE\r\n// e.g. http://example.com/#/some-path -> http://example.com/some-path\r\nhistory.redirect();"]}